# Протоколы передачи ключей

- Протоколы раздачи ранее сгенерированных ключей
- Протоколы совместной выработки общего ключа
- Схемы предварительного распределения ключей

А также:
- личные протоколы
- протоколы с доверенным центром

### С использованием цифровой подписи

Вопрос аутентификации источника ключа.
Просто подписываешь что надо своей подписью, и всем понятно, что это ты.
Например:
```
A -> B: Eb(K, T), SignA(B, K, T)
or
A -> B: Eb(K, T, SignA(B, K, T))
or
A -> B: T, Eb(A, K), SignA(B, T, Eb(A, K))
```

### Wide-mouth frog

Протокол передачи ключей с третьей стороной.

```
A -> T: A, E_{Kat}(Ta, B, K)
T -> B:    E_{Kbt}(Tt, A, K)
```

Атака:
```
   A -> T:    A, E_{Kat}(Ta, B, K)  -- 1
   T -> B:    E_{Kbt}(Tt, A, K)     -- 1
C(B) -> T:    B, E_{Kbt}(Tt, A, K)  -- 2
   T -> C(A): E_{Kat}(T't, B, K)    -- 2
C(A) -> T:    A, E_{Kat}(T't, B, K) -- 3
   T -> C(B): E_Kbt(T''t, A, K)     -- 3
Next, the real attack:
   A -> C(T): A, E_{Kat}(T'a, B, K)
C(T) -> B:    E_Kbt(T''t, A, K)
```

### Бесключевой Шамира

Метод двух замков и одного контейнера.
Строится на основе коммутирующих функций шифрования, например, возведение в
степень (ДХ).

Атака - банальный МИТМ.

### Нидхема-Шрёдера

```
A -> T: A, B, Ra
T -> A: E_{Kat}(Ra, B, K, E_{Kbt}(K, A))
A -> B: E_{Kbt}(K, A)
B -> A: Ek(Rb)
A -> B: Ek(Rb - 1)
```

Атака - третий шаг можно переиспользовать.

Модификация Denning-Sacco:
```
A -> T: A, B
T -> A: E_{Kat}(B, K, T, E_{Kbt}(K, A, T))
A -> B: E_{Kbt}(K, A, T)
```

### Kerberos

Модификация NS. Базовый:
```
A -> T: A, B, Ra
T -> A: E_{Kat}(K, Ra, L, B), ticket
A -> B: ticket, auther
B -> A: Ek(T, Kb)
where
  ticket = E_{Kbt}(K, A, L)
  auther = Ek(A, T, Ka)
  T - current time
  L - ticket lifetime
```
В протоколе есть два Т: AS и TGS.
AS выдаёт тикеты только для общения с TGS,
а TGS выдаёт тикеты для общения со всеми остальными.
