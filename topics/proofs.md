# Протоколы доказательства знания и идентификация

Proof of knowledge - интерактивое доказательство владения секретной информацией.
Интерактивное доказательство - протокол,
в котором одна сторона убеждает другую в верности утверждения,
либо другая сторона приходит к выводу о неверности.
Это важно, потому что вторая сторона должна мочь обнаружить злоумышленника,
пытающегося впарить какую-то дичь.
Обычно доказательство имеет вероятностную природу.

### Свойства

* Полнота - возможность доказывать верные вещи
* Корректность - невозможность доказывать неверные вещи
* Нулевое разглашение - о доказываемом утверждении не будет получено никаких данных,
  кроме информации о его истинности.

### Изоморфизм графов

[source](https://neerc.ifmo.ru/wiki/index.php?title=Доказательства_с_нулевым_разглашением)

Нужно доказать изоморфизм G0 и G1, не раскрывая самого изоморфизма.
В каждом раунде выбирается Н - случайная перестановка G0,
и доказывается рандомно либо изоморфизм Н и G0, либо изоморфизм Н и G1.

Не забыть полноту и корректность.

### Гамильтонов цикл

[source](https://ru.wikipedia.org/wiki/Доказательство_с_нулевым_разглашением#Гамильтонов_цикл_для_больших_графов)

Как и в прошлом примере в каждом раунде берётся перестановка,
и доказывактся рандомно либо изоморфизм с ней, либо наличие гамильтонова цикла в ней.

Не забыть полноту и корректность.

## Идентификация

Нужно доказать знание секрета без разглашения самого секрета

### GQ

n = pq - модуль RSA; b - взаимно просто с phi(n). n и b - открытые параметры.
Секретный ключ u взаимно прост с n.
Открытый ключ v = u^(-b) mod n.

Раунд:
```
A -> B: cert_A, R^b mod n
B -> A: x
A -> B: y = R * u^x
Check:
R^b = v^x * y^b = u^(-bx + xb) * R^b
```

_Полнота:_ очевидно.

_Корректонсть:_ Черёмушкин, 130-131.


### Фиата-Шамира

Берётся модуль RSA n = pq; a - секрет, b = a^(-2) - открытый параметр.

Раунд:
```
A -> B: R^2 mod n
B -> A: x <- {0, 1}
A -> B: R * a^x mod n
Check:
(R * a^x)^2 * b = R^2
```

_Полнота:_ очевидно.

_Корректность:_ обмануть можно либо
отправив как R некоторое z и ответить на вопрос с х = 0, послав просто z,
либо послав z^2 * b^(-1), и ответить на вопрос с x = 1, послав просто z.
Таким образом, вероятность обмана: `1/2(1 + 1/n) --> 2^(-t)`

_Нулевое разглашение:_ заметим, что число зависит от секрета _а_ только на
третьем этапе, и что если В выберет наугад его и _х_, то он сможет получить
корректное число с первого этапа, а значит он не получает новой информации.

### Шнорра

_p_ - простое, _q_ делит _p-1_, _w_ - элемент кольца вычетов по модулю _р_ порядка _q_.
Секрет: 1 <= _a_ <= q - 2, открытый параметр - _v_ = w^(-a).
cert_A - сертификат открытого ключа участника А.

Раунд:
```
A -> B: cert_A, w^R (mod p)
B -> A: x
A -> B: R + ax (mod q) = y
Check:
w^R = w^y * v^x = w^(R + ax + x*(-a))
```

_Полнота:_ очевидно.

_Корректность:_ лучше взять из книги: Черёмушкин, страница 126.

_Нулевое разглашение:_ как выше вычисляем число первого этапа из всех остальных.

### Окамото

_p_ - простое, _q_ делит _p-1_
, _w1_ и _w2_ - элементы кольца вычетов по модулю _р_ порядка _q_.
Секрет: 1 <= _a1_, _a2_ <= q - 2, открытый параметр - _v_ = w1^(-a1) * w2^(-a2).
cert_A - сертификат открытого ключа участника А.

Раунд:
```
A -> B: cert_A, w1^R1 * w2^R2
B -> A: x
A -> B: y1 = R1 + a1*x (mod q)
        y2 = R2 + a2*x (mod q)
Check:
w1^R1 * w2^R2 = w1^y1 * w2^y2 * v^x
```
_Полнота:_ очевидно. Зачем я пишу это в четвёртый раз?

_Корректность:_ очень сложно, лучше взять из книги: Черёмушкин, страница 128-130.

_Нулевое разглашение:_ как выше вычисляем число первого этапа из всех остальных.
